"use strict";(self.webpackChunkngo_project_fe=self.webpackChunkngo_project_fe||[]).push([[479],{1479:(L,_,r)=>{r.r(_),r.d(_,{QuestionnairePageModule:()=>H});var p=r(6814),u=r(1896),t=r(5879),f=r(5836),b=r(4129);function v(i,s){if(1&i&&(t.TgZ(0,"li")(1,"span"),t._uU(2),t.qZA()()),2&i){const n=s.$implicit,e=s.first,o=t.oxw();t.ekj("inactive",n.id>o.phaseId+1)("first",1===n.id)("second",2===n.id)("third",3===n.id)("not-first",!e),t.xp6(1),t.ekj("active-status",n.id<=o.phaseId+1),t.xp6(1),t.Oqu(n.name)}}let x=(()=>{class i{constructor(){this.phasesList=[{name:"Adapta\u010dn\xe1 f\xe1za",id:1},{name:"Podporn\xe1 f\xe1za",id:2},{name:"Aktiviza\u010dn\xe1 f\xe1za",id:3}],this.phaseId=1}static#t=this.\u0275fac=function(e){return new(e||i)};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-phases-progressbar"]],inputs:{phaseId:"phaseId"},decls:3,vars:1,consts:[[1,"progress-div"],[1,"progress"],[3,"inactive","first","second","third","not-first",4,"ngFor","ngForOf"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"ul",1),t.YNc(2,v,3,13,"li",2),t.qZA()()),2&e&&(t.xp6(2),t.Q6J("ngForOf",o.phasesList))},dependencies:[p.sg],styles:['.progress-div[_ngcontent-%COMP%]{box-sizing:border-box;padding-bottom:15px}.progress[_ngcontent-%COMP%]{padding:0;list-style-type:none;font-family:arial;font-size:12px;clear:both;line-height:1em;margin:0 -1px;text-align:center;background-color:transparent!important}.progress[_ngcontent-%COMP%]   li.first[_ngcontent-%COMP%]{float:left;padding:10px 30px 10px 40px;background:linear-gradient(.25turn,#FF4D00,#FC7900);color:#fff;position:relative;width:32.8%;margin:0 1px}.progress[_ngcontent-%COMP%]   li.second[_ngcontent-%COMP%]{float:left;padding:10px 30px 10px 40px;background:linear-gradient(.25turn,#FC7900,#FF9900);color:#fff;position:relative;width:32.8%;margin:0 1px}.progress[_ngcontent-%COMP%]   li.third[_ngcontent-%COMP%]{float:left;padding:10px 30px 10px 40px;background:linear-gradient(.25turn,#FF9900,#FFB800);color:#fff;position:relative;width:32.8%;margin:0 1px}.progress[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0}.progress[_ngcontent-%COMP%]   li.not-first[_ngcontent-%COMP%]:before{border-left:16px solid #fff;border-top:16px solid transparent;border-bottom:16px solid transparent}.progress[_ngcontent-%COMP%]   li.first[_ngcontent-%COMP%]:after{content:"";border-left:16px solid #FC7900;border-top:16px solid transparent;border-bottom:16px solid transparent;position:absolute;top:0;left:100%;z-index:20}.progress[_ngcontent-%COMP%]   li.second[_ngcontent-%COMP%]:after{content:"";border-left:16px solid #FF9900;border-top:16px solid transparent;border-bottom:16px solid transparent;position:absolute;top:0;left:100%;z-index:20}.progress[_ngcontent-%COMP%]   li.third[_ngcontent-%COMP%]:after{content:"";border-left:16px solid #FFB800;border-top:16px solid transparent;border-bottom:16px solid transparent;position:absolute;top:0;left:100%;z-index:20}.progress[_ngcontent-%COMP%]   li.inactive[_ngcontent-%COMP%]{color:#5c5c5c;background:#EFEFEF}.progress[_ngcontent-%COMP%]   li.inactive[_ngcontent-%COMP%]:after{border-left-color:#efefef}.progress[_ngcontent-%COMP%]   li.completed[_ngcontent-%COMP%]{width:2%!important}.progress[_ngcontent-%COMP%]   .active-status[_ngcontent-%COMP%]{font-weight:700}.progress[_ngcontent-%COMP%], .progress-stacked[_ngcontent-%COMP%]{--bs-progress-height: 100% !important}']})}return i})();var O=r(590),P=r(1449),l=r(7700);let M=(()=>{class i{constructor(n,e){this.clientService=n,this.data=e,this.client=this.clientService.getSelectedClient()}static#t=this.\u0275fac=function(e){return new(e||i)(t.Y36(f.y),t.Y36(l.WI))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-modal-window"]],decls:18,vars:3,consts:[["align","center"],["src","../../../../../../../assets/images/send_popup.svg"],["mat-dialog-title",""],["align","center",1,"dialog-text"],["mat-button","","mat-dialog-close","",1,"cancel-button"],["mat-button","","cdkFocusInitial","",1,"submit-button",3,"mat-dialog-close"]],template:function(e,o){1&e&&(t.TgZ(0,"mat-dialog-content",0),t._UZ(1,"img",1),t.qZA(),t.TgZ(2,"h1",2),t._uU(3,"ULO\u017dI\u0164 ZMENY?"),t.qZA(),t.TgZ(4,"mat-dialog-content",3)(5,"p"),t._uU(6),t.qZA(),t.TgZ(7,"p"),t._uU(8),t.qZA()(),t.TgZ(9,"mat-dialog-actions",0)(10,"button",4),t._uU(11,"NIE"),t.qZA(),t.TgZ(12,"button",5),t._uU(13,"\xc1NO"),t.qZA()(),t.TgZ(14,"mat-dialog-content",0)(15,"p")(16,"b"),t._uU(17,"Hodnotenie je mo\u017en\xe9 upravi\u0165 v hist\xf3rii pozorovac\xedch h\xe1rkov."),t.qZA()()()),2&e&&(t.xp6(6),t.hij("Che\u0161 natrvalo ulo\u017ei\u0165 hodnotenie klienta? Po ulo\u017een\xed zmien sa f\xe1za \u010d. ",o.client.last_phase+1," uzavrie."),t.xp6(2),t.hij("V pozorovacom h\xe1rku je ",o.data.unasweredQuestions," nevyplnen\xfdch ot\xe1zok."),t.xp6(4),t.Q6J("mat-dialog-close",!0))},dependencies:[l.ZT,l.uh,l.xY,l.H8],styles:[".dialog-text[_ngcontent-%COMP%]{text-align:center;padding:2rem 0}.submit-button[_ngcontent-%COMP%]{padding:1rem 4rem;border-radius:50px;font-weight:600;color:#fff;background:linear-gradient(.25turn,#FF4D00,#FC7900);border:none}.submit-button[_ngcontent-%COMP%]:hover{background:linear-gradient(88deg,#D44900 -.01%,#FF6C1D 100.02%)}.cancel-button[_ngcontent-%COMP%]{padding:1rem 4rem;border-radius:50px;font-weight:600;color:#ff4d00;background:white;border:1px solid #FF4D00;margin-right:1rem}.cancel-button[_ngcontent-%COMP%]:hover{background:linear-gradient(90deg,#FF4D00 0%,#FC7900 99.99%);color:#fff}"]})}return i})();var F=r(553),Z=r(9862);let y=(()=>{class i{constructor(n){this.http=n,this.baseUrl=F.N.baseUrl}getQuestionnaire(){return this.http.get(`${this.baseUrl}/ngo/questionnaire`)}static#t=this.\u0275fac=function(e){return new(e||i)(t.LFG(Z.eN))};static#e=this.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var c=r(6223),h=r(5597),C=r(2939),g=r(1545);const q=["stepper"],w=["shownCategory"];function Q(i,s){if(1&i&&t._UZ(0,"i"),2&i){const n=s.index,e=t.oxw();t.Gre("fas ",e.questionnaire[n].icon,"")}}function T(i,s){if(1&i&&t._UZ(0,"i"),2&i){const n=s.index,e=t.oxw();t.Gre("fas ",e.questionnaire[n].icon,"")}}function S(i,s){if(1&i&&t._UZ(0,"i"),2&i){const n=s.index,e=t.oxw();t.Gre("fas ",e.questionnaire[n].icon,"")}}function U(i,s){if(1&i&&t._UZ(0,"mat-step",14),2&i){const n=s.index,e=t.oxw();t.Q6J("completed",n<=e.currentStep)("editable",!0)}}const m=function(){return["fas","xmark"]};function D(i,s){if(1&i&&(t.TgZ(0,"tr")(1,"td",24),t._uU(2),t.qZA(),t.TgZ(3,"td",19)(4,"label"),t._UZ(5,"input",25),t.TgZ(6,"span",26),t._UZ(7,"fa-icon",20),t.qZA()()(),t.TgZ(8,"td",19)(9,"label"),t._UZ(10,"input",27),t.TgZ(11,"span",26),t._UZ(12,"fa-icon",21),t.qZA()()(),t.TgZ(13,"td",19)(14,"label"),t._UZ(15,"input",28),t.TgZ(16,"span",26),t._UZ(17,"fa-icon",22),t.qZA()()()()),2&i){const n=s.$implicit;t.xp6(2),t.Oqu(n.question),t.xp6(3),t.s9C("formControlName",n._id),t.xp6(2),t.Q6J("icon",t.DdM(7,m)),t.xp6(3),t.s9C("formControlName",n._id),t.xp6(2),t.Q6J("icon",t.DdM(8,m)),t.xp6(3),t.s9C("formControlName",n._id),t.xp6(2),t.Q6J("icon",t.DdM(9,m))}}const I=function(){return["fas","face-frown"]},A=function(){return["fas","face-meh"]},k=function(){return["fas","face-smile"]};function N(i,s){if(1&i&&(t.TgZ(0,"li",15)(1,"h1",16,17),t._uU(3),t.qZA(),t.TgZ(4,"table")(5,"thead")(6,"tr"),t._UZ(7,"th",18),t.TgZ(8,"th",19),t._UZ(9,"fa-icon",20),t.qZA(),t.TgZ(10,"th",19),t._UZ(11,"fa-icon",21),t.qZA(),t.TgZ(12,"th",19),t._UZ(13,"fa-icon",22),t.qZA()()(),t.TgZ(14,"tbody"),t.YNc(15,D,18,10,"tr",23),t.qZA()()()),2&i){const n=s.$implicit;t.xp6(1),t.s9C("id",n.icon),t.xp6(2),t.Oqu(n.category),t.xp6(6),t.Q6J("icon",t.DdM(6,I)),t.xp6(2),t.Q6J("icon",t.DdM(7,A)),t.xp6(2),t.Q6J("icon",t.DdM(8,k)),t.xp6(2),t.Q6J("ngForOf",n.questions)}}function z(i,s){1&i&&(t.TgZ(0,"button",29),t._uU(1,"VYHODNOTI\u0164"),t.qZA())}let J=(()=>{class i{isScrolledIntoView(){setTimeout(()=>{for(let n=0;n<this.titles.length;n++){const e=document.getElementById(this.questionnaire[n].icon)?.getBoundingClientRect(),o=e?.top?e?.top>=0:void 0,a=e?.bottom?e?.bottom<=window.innerHeight:void 0;o&&a&&(this.currentStep=n)}},1500)}constructor(n,e,o,a,d,j,V,G){this.questionnaireService=n,this.fb=e,this.ratingService=a,this.clientService=d,this.saveMessageBar=j,this.dialog=V,this.router=G,this.questionnaire=[],this.currentStep=0,this.isHistory=!1,this.questForm=this.fb.group({}),o.addIconPacks(O.mRB,P.NCV)}ngOnInit(){this.isHistory=this.ratingService.getHistory(),this.subscription=this.questionnaireService.getQuestionnaire().subscribe(n=>{this.questionnaire=n;let e={};for(let o=0;o<this.questionnaire.length;o++)this.questionnaire[o].questions.forEach(a=>{e[a._id]=void 0===this.prefill_questionnaire?["0"]:[String(this.prefill_questionnaire.questions_rating.filter(d=>d.question_id==a._id)[0].rating)]}),this.questForm=this.fb.group(e)})}ngAfterViewInit(){this.stepper.selectedIndexChange.subscribe(n=>{this.currentStep=n,document.getElementById(this.questionnaire[n].icon)?.scrollIntoView()})}ngOnDestroy(){}saveFormData(){let n={date_rated:new Date,rated_by_user_id:localStorage.getItem("user_name")+" "+localStorage.getItem("user_surname"),client_id:this.client?._id?this.client._id:0,phase_no:this.prefill_questionnaire?this.prefill_questionnaire?.phase_no:this.client?.last_phase+1,questions_rating:[]};this.questionnaire.forEach(e=>{e.questions.forEach(o=>{n.questions_rating.push({question_id:o._id,rating:Number(this.questForm.value[o._id]),question:o.question,category:e.category,icon:e.icon})})}),this.subscription2=this.ratingService.postRating(n).subscribe({next:e=>{this.saveMessageBar.open("Pozorovac\xed h\xe1rok bol \xfaspe\u0161ne ulo\u017een\xfd!","X",{horizontalPosition:"end",verticalPosition:"bottom",duration:2e3})},error:e=>{this.saveMessageBar.open("Nie\u010do sa pokazilo. Sk\xfaste to znova, pros\xedm.","X",{horizontalPosition:"end",verticalPosition:"bottom",duration:2e3})}})}submitFormData(){let n={date_rated:new Date,rated_by_user_id:localStorage.getItem("user_name")+" "+localStorage.getItem("user_surname"),client_id:this.client?._id?this.client._id:0,phase_no:this.client?.last_phase?this.client.last_phase+1:1,questions_rating:[]};return this.client.last_phase<3?this.client.last_phase=this.client.last_phase+1:this.client.active=!1,this.questionnaire.forEach(e=>{e.questions.forEach(o=>{n.questions_rating.push({question_id:o._id,rating:Number(this.questForm.value[o._id]),question:o.question,category:e.category,icon:e.icon})})}),this.clientService.editClient(this.client).subscribe({next:e=>{},error:e=>!1}),this.subscription2=this.ratingService.postRating(n).subscribe({next:e=>{},error:e=>!1}),!0}countUnansweredQuestions(n){let e=0;for(let o in n)"0"===n[o]&&e++;return e}onSubmit(){this.dialog.open(M,{data:{unasweredQuestions:this.countUnansweredQuestions(this.questForm.value)}}).afterClosed().subscribe(e=>{e&&this.submitFormData()&&this.router.navigate(["/questionnaire-sent"])})}static#t=this.\u0275fac=function(e){return new(e||i)(t.Y36(y),t.Y36(c.qu),t.Y36(h.by),t.Y36(b.V),t.Y36(f.y),t.Y36(C.ux),t.Y36(l.uw),t.Y36(u.F0))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-questionnaire"]],viewQuery:function(e,o){if(1&e&&(t.Gf(q,5),t.Gf(w,5)),2&e){let a;t.iGM(a=t.CRH())&&(o.stepper=a.first),t.iGM(a=t.CRH())&&(o.titles=a)}},hostBindings:function(e,o){1&e&&t.NdJ("scroll",function(d){return o.isScrolledIntoView(d)},!1,t.Jf7)},inputs:{client:"client",prefill_questionnaire:"prefill_questionnaire"},decls:16,vars:5,consts:[[3,"formGroup","ngSubmit"],[1,"row","col-md-12"],[1,"col-md-2"],[1,"stepper-position",3,"selectedIndex"],["stepper",""],["matStepperIcon","number"],["matStepperIcon","edit"],["matStepperIcon","done"],["state","number",3,"completed","editable",4,"ngFor","ngForOf"],[1,"col-md-10"],["class","list-category",4,"ngFor","ngForOf"],[1,"submit-position"],["type","button",1,"save-button",3,"click"],["type","submit","class","submit-button",4,"ngIf"],["state","number",3,"completed","editable"],[1,"list-category"],[1,"category-space",3,"id"],["shownCategory",""],[2,"width","60%"],[2,"text-align","center"],[1,"rating-icon","rating-icon--red",3,"icon"],[1,"rating-icon","rating-icon--yellow",3,"icon"],[1,"rating-icon","rating-icon--green",3,"icon"],[4,"ngFor","ngForOf"],[2,"font-size","18px"],["type","radio","value","1",3,"formControlName"],[1,"xbutton-label"],["type","radio","value","2",3,"formControlName"],["type","radio","value","3",3,"formControlName"],["type","submit",1,"submit-button"]],template:function(e,o){1&e&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return o.onSubmit()}),t.TgZ(1,"div",1)(2,"div",2)(3,"mat-vertical-stepper",3,4),t.YNc(5,Q,1,3,"ng-template",5),t.YNc(6,T,1,3,"ng-template",6),t.YNc(7,S,1,3,"ng-template",7),t.YNc(8,U,1,2,"mat-step",8),t.qZA()(),t.TgZ(9,"div",9)(10,"ul"),t.YNc(11,N,16,9,"li",10),t.qZA(),t.TgZ(12,"div",11)(13,"button",12),t.NdJ("click",function(){return o.saveFormData()}),t._uU(14,"ULO\u017dI\u0164"),t.qZA(),t.YNc(15,z,2,0,"button",13),t.qZA()()()()),2&e&&(t.Q6J("formGroup",o.questForm),t.xp6(3),t.Q6J("selectedIndex",o.currentStep),t.xp6(5),t.Q6J("ngForOf",o.questionnaire),t.xp6(3),t.Q6J("ngForOf",o.questionnaire),t.xp6(4),t.Q6J("ngIf",!o.isHistory))},dependencies:[p.sg,p.O5,h.BN,c._Y,c.Fj,c._,c.JJ,c.JL,c.sg,c.u,g.C0,g.Vq,g.z9],styles:["*[_ngcontent-%COMP%], *[_ngcontent-%COMP%]:before, *[_ngcontent-%COMP%]:after{padding:0;margin:0;box-sizing:border-box}.list-category[_ngcontent-%COMP%]{list-style-type:none}.category-space[_ngcontent-%COMP%]{font-weight:700;padding-top:5rem}.list-question[_ngcontent-%COMP%]{padding:1rem 1.5rem 1rem 0rem}.submit-position[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;padding:2rem 0}.submit-button[_ngcontent-%COMP%]{padding:1rem 4rem;border-radius:50px;font-weight:600;color:#fff;background:linear-gradient(.25turn,#FF4D00,#FC7900);border:none}.submit-button[_ngcontent-%COMP%]:hover{background:linear-gradient(88deg,#D44900 -.01%,#FF6C1D 100.02%)}.save-button[_ngcontent-%COMP%]{padding:1rem 4rem;border-radius:50px;font-weight:600;color:#ff4d00;background:white;border:1px solid #FF4D00;margin-right:1rem}.save-button[_ngcontent-%COMP%]:hover{background:linear-gradient(90deg,#FF4D00 0%,#FC7900 99.99%);color:#fff}table[_ngcontent-%COMP%]{width:100%}td[_ngcontent-%COMP%]{padding:1rem 0;border-bottom:1px solid #D9D9D9;border-right:1px dashed #D9D9D9}td[_ngcontent-%COMP%]:last-child{border-right:none}.rating-icon[_ngcontent-%COMP%]{font-size:40px}.rating-icon--green[_ngcontent-%COMP%]{color:#189d5f}.rating-icon--yellow[_ngcontent-%COMP%]{color:#ff9a65}.rating-icon--red[_ngcontent-%COMP%]{color:#ff5800}input[type=radio][_ngcontent-%COMP%]{-webkit-appearance:none}.xbutton-label[_ngcontent-%COMP%]{cursor:pointer;opacity:5%}.xbutton-label[_ngcontent-%COMP%]:hover{opacity:100%}input[type=radio][_ngcontent-%COMP%]:checked + .xbutton-label[_ngcontent-%COMP%]{opacity:100%}  .mat-vertical-stepper-content{visibility:visible!important;height:100%!important}[_nghost-%COMP%]     .mat-step-icon-state-edit{color:#ff5800;background:white;border:1px solid #FF5800}[_nghost-%COMP%]     .mat-step-icon-selected{color:#ff5800!important;background:white!important;border:1px solid #FF5800!important}[_nghost-%COMP%]     .mat-step-icon-state-number{color:#929292;background:white;border:1px solid #929292}[_nghost-%COMP%]     .mat-stepper-vertical-line:before{border-left-width:3.5px!important}[_ngcontent-%COMP%]:is()[ng-reflect-state=edit] + .mat-stepper-vertical-line[_ngcontent-%COMP%]{border-left-color:#ff5800!important}.stepper-position[_ngcontent-%COMP%]{position:fixed;padding-top:2.5rem}[_nghost-%COMP%]     .mat-mdc-snack-bar-container .mdc-snackbar__surface{background-color:#90ee90!important}"]})}return i})();const E=function(i){return["/client-overview",i]},Y=[{path:"",component:(()=>{class i{constructor(n,e,o){this.router=n,this.clientService=e,this.ratingService=o,this.client={_id:0,name:"",surname:"",last_phase:1,registration_date:new Date,active:!0},this.phase_no=0}ngOnInit(){this.client=this.clientService.getSelectedClient(),this.ratingService.getHistory()?(this.unfinished_rating=this.ratingService.getHistoryQuestionnaire(),console.log(this.unfinished_rating),this.phase_no=this.unfinished_rating.phase_no-1):(this.phase_no=this.client.last_phase,this.ratingService.getRatingsByClientId(Number(this.client._id)).subscribe(n=>{n.forEach(e=>{e.phase_no==this.client.last_phase+1&&(this.unfinished_rating=e)})}))}static#t=this.\u0275fac=function(e){return new(e||i)(t.Y36(u.F0),t.Y36(f.y),t.Y36(b.V))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-questionnaire-page"]],decls:11,vars:12,consts:[[3,"phaseId"],[2,"margin","0 10%"],[1,"navigation"],[3,"routerLink"],[1,"fa","fa-chevron-left","fa-lg","fa-light"],[3,"client","prefill_questionnaire"]],template:function(e,o){1&e&&(t._UZ(0,"app-phases-progressbar",0),t.TgZ(1,"div",1)(2,"div",2)(3,"a",3),t._UZ(4,"i",4),t._uU(5," Sp\xe4\u0165 na preh\u013ead"),t.qZA(),t.TgZ(6,"p"),t._uU(7),t.ALo(8,"uppercase"),t.ALo(9,"uppercase"),t.qZA()(),t._UZ(10,"app-questionnaire",5),t.qZA()),2&e&&(t.Q6J("phaseId",o.phase_no),t.xp6(3),t.Q6J("routerLink",t.VKq(10,E,o.client._id)),t.xp6(4),t.AsE("",t.lcZ(8,6,o.client.name)," ",t.lcZ(9,8,o.client.surname),""),t.xp6(3),t.Q6J("client",o.client)("prefill_questionnaire",o.unfinished_rating))},dependencies:[u.rH,x,J,p.gd],styles:[".navigation[_ngcontent-%COMP%]{color:#929090;display:flex;flex-direction:row;justify-content:space-between;padding-top:1rem}a[_ngcontent-%COMP%]{color:#929090;text-decoration:none}"]})}return i})()}];let B=(()=>{class i{static#t=this.\u0275fac=function(e){return new(e||i)};static#e=this.\u0275mod=t.oAB({type:i});static#n=this.\u0275inj=t.cJS({imports:[u.Bz.forChild(Y),u.Bz]})}return i})(),H=(()=>{class i{static#t=this.\u0275fac=function(e){return new(e||i)};static#e=this.\u0275mod=t.oAB({type:i});static#n=this.\u0275inj=t.cJS({imports:[p.ez,B,h.uH,c.u5,c.UX,g.T5,C.ZX,l.Is]})}return i})()}}]);